M =[                                                                                                                                                                                                                                                                                                                                                       27947/500, (1961*cos(th2))/40000 + (711*sin(th2))/50000 + (2339653*cos(th2)*sin(th3))/500000 + (73161*cos(th2)*cos(th3))/500000 - (1533389*cos(th2)*cos(th3)*cos(th4))/1000000 + (32169*cos(th2)*cos(th3)*sin(th4))/200000 + (32169*cos(th2)*cos(th4)*sin(th3))/200000 + (1533389*cos(th2)*sin(th3)*sin(th4))/1000000,  sin(th2)*((5479328692330^(1/2)*cos(atan(73161/2339653) + th3))/500000 + (10723*20674^(1/2)*sin(atan(15/143) + th3 + th4))/1000000),     (10723*20674^(1/2)*sin(atan(15/143) + th3 + th4)*sin(th2))/1000000
    (1961*cos(th2))/40000 + (711*sin(th2))/50000 + (2339653*cos(th2)*sin(th3))/500000 + (73161*cos(th2)*cos(th3))/500000 - (1533389*cos(th2)*cos(th3)*cos(th4))/1000000 + (32169*cos(th2)*cos(th3)*sin(th4))/200000 + (32169*cos(th2)*cos(th4)*sin(th3))/200000 + (1533389*cos(th2)*sin(th3)*sin(th4))/1000000,                                (310967*20674^(1/2)*cos(atan(143/15) - th4))/100000000 - (310967*20674^(1/2)*cos(2*th3 - atan(143/15) + th4))/100000000 - (3*1636869206119633^(1/2)*cos(atan(4755332/202235301) + 2*th3))/200000000 + (33477084385009801^(1/2)*cos(atan(14000835/182430976) + 2*th3 + 2*th4))/1000000000 + 917438051/1000000000, (310374939346^(1/2)*cos(th3 - atan(533389/160845) + th4))/1000000000 + (11158634692330^(1/2)*cos(atan(73161/3339653) + th3))/500000000,      (310374939346^(1/2)*sin(atan(160845/533389) + th3 + th4))/1000000000
    (sin(th2)*(2*5479328692330^(1/2)*cos(atan(73161/2339653) + th3) + 10723*20674^(1/2)*sin(atan(15/143) + th3 + th4)))/1000000,                                                                                                                                                                                                                  (310374939346^(1/2)*cos(th3 - atan(533389/160845) + th4))/1000000000 + (11158634692330^(1/2)*cos(atan(73161/3339653) + th3))/500000000,                                                                   (310967*20674^(1/2)*cos(atan(143/15) - th4))/50000000 + 101769887/62500000, (310967*20674^(1/2)*cos(atan(143/15) - th4))/100000000 + 192843651/500000000
    (10723*20674^(1/2)*sin(atan(15/143) + th3 + th4)*sin(th2))/1000000,                                                                                                                                                                                                                                                                                       (310374939346^(1/2)*cos(th3 - atan(533389/160845) + th4))/1000000000,                                                                 (310967*20674^(1/2)*cos(atan(143/15) - th4))/100000000 + 192843651/500000000,                                                             192843651/500000000];

V =[(711*cos(th2)*th2_dt^2)/50000 - (1961*sin(th2)*th2_dt^2)/40000 - (73161*cos(th3)*sin(th2)*th2_dt^2)/500000 - (73161*cos(th3)*sin(th2)*th3_dt^2)/500000 - (2339653*sin(th2)*sin(th3)*th2_dt^2)/500000 - (2339653*sin(th2)*sin(th3)*th3_dt^2)/500000 + (1533389*cos(th3)*cos(th4)*sin(th2)*th2_dt^2)/1000000 + (1533389*cos(th3)*cos(th4)*sin(th2)*th3_dt^2)/1000000 + (1533389*cos(th3)*cos(th4)*sin(th2)*th4_dt^2)/1000000 + (2339653*cos(th2)*cos(th3)*th2_dt*th3_dt)/250000 - (32169*cos(th3)*sin(th2)*sin(th4)*th2_dt^2)/200000 - (32169*cos(th4)*sin(th2)*sin(th3)*th2_dt^2)/200000 - (32169*cos(th3)*sin(th2)*sin(th4)*th3_dt^2)/200000 - (32169*cos(th4)*sin(th2)*sin(th3)*th3_dt^2)/200000 - (32169*cos(th3)*sin(th2)*sin(th4)*th4_dt^2)/200000 - (32169*cos(th4)*sin(th2)*sin(th3)*th4_dt^2)/200000 - (73161*cos(th2)*sin(th3)*th2_dt*th3_dt)/250000 - (1533389*sin(th2)*sin(th3)*sin(th4)*th2_dt^2)/1000000 - (1533389*sin(th2)*sin(th3)*sin(th4)*th3_dt^2)/1000000 - (1533389*sin(th2)*sin(th3)*sin(th4)*th4_dt^2)/1000000 + (32169*cos(th2)*cos(th3)*cos(th4)*th2_dt*th3_dt)/100000 + (32169*cos(th2)*cos(th3)*cos(th4)*th2_dt*th4_dt)/100000 + (1533389*cos(th2)*cos(th3)*sin(th4)*th2_dt*th3_dt)/500000 + (1533389*cos(th2)*cos(th4)*sin(th3)*th2_dt*th3_dt)/500000 + (1533389*cos(th2)*cos(th3)*sin(th4)*th2_dt*th4_dt)/500000 + (1533389*cos(th2)*cos(th4)*sin(th3)*th2_dt*th4_dt)/500000 + (1533389*cos(th3)*cos(th4)*sin(th2)*th3_dt*th4_dt)/500000 - (32169*cos(th2)*sin(th3)*sin(th4)*th2_dt*th3_dt)/100000 - (32169*cos(th2)*sin(th3)*sin(th4)*th2_dt*th4_dt)/100000 - (32169*cos(th3)*sin(th2)*sin(th4)*th3_dt*th4_dt)/100000 - (32169*cos(th4)*sin(th2)*sin(th3)*th3_dt*th4_dt)/100000 - (1533389*sin(th2)*sin(th3)*sin(th4)*th3_dt*th4_dt)/500000
    (533389*cos(th3 + th4)*th3_dt^2)/1000000000 + (533389*cos(th3 + th4)*th4_dt^2)/1000000000 - (32169*sin(th3 + th4)*th3_dt^2)/200000000 - (32169*sin(th3 + th4)*th4_dt^2)/200000000 - (73161*cos(th3)*th3_dt^2)/500000000 - (3339653*sin(th3)*th3_dt^2)/500000000 + (44468281*cos(th4)*th2_dt*th4_dt)/100000000 - (2800167*cos(2*th3 + 2*th4)*th2_dt*th3_dt)/100000000 - (2800167*cos(2*th3 + 2*th4)*th2_dt*th4_dt)/100000000 - (932901*sin(th4)*th2_dt*th4_dt)/20000000 - (712621*sin(2*th3 + 2*th4)*th2_dt*th3_dt)/1953125 - (712621*sin(2*th3 + 2*th4)*th2_dt*th4_dt)/1953125 + (533389*cos(th3 + th4)*th3_dt*th4_dt)/500000000 - (32169*sin(th3 + th4)*th3_dt*th4_dt)/100000000 + (3566499*cos(2*th3)*th2_dt*th3_dt)/125000000 + (606705903*sin(2*th3)*th2_dt*th3_dt)/500000000 - (44468281*cos(2*th3 + th4)*th2_dt*th3_dt)/50000000 - (44468281*cos(2*th3 + th4)*th2_dt*th4_dt)/100000000 + (932901*sin(2*th3 + th4)*th2_dt*th3_dt)/10000000 + (932901*sin(2*th3 + th4)*th2_dt*th4_dt)/20000000
    (44468281*cos(2*th3 + th4)*th2_dt^2)/100000000 - (606705903*sin(2*th3)*th2_dt^2)/1000000000 - (3566499*cos(2*th3)*th2_dt^2)/250000000 - (932901*sin(2*th3 + th4)*th2_dt^2)/20000000 + (44468281*cos(th4)*th4_dt^2)/100000000 + (2800167*cos(2*th3 + 2*th4)*th2_dt^2)/200000000 - (932901*sin(th4)*th4_dt^2)/20000000 + (712621*sin(2*th3 + 2*th4)*th2_dt^2)/3906250 + (44468281*cos(th4)*th3_dt*th4_dt)/50000000 - (932901*sin(th4)*th3_dt*th4_dt)/10000000
    (44468281*cos(2*th3 + th4)*th2_dt^2)/200000000 - (932901*sin(2*th3 + th4)*th2_dt^2)/40000000 - (44468281*cos(th4)*th2_dt^2)/200000000 - (44468281*cos(th4)*th3_dt^2)/100000000 + (2800167*cos(2*th3 + 2*th4)*th2_dt^2)/200000000 + (932901*sin(th4)*th2_dt^2)/40000000 + (932901*sin(th4)*th3_dt^2)/20000000 + (712621*sin(2*th3 + 2*th4)*th2_dt^2)/3906250];
G =[                                                                                                                                               0
    0
    (1533389*g*cos(th3 + th4))/1000000 - (2339653*g*sin(th3))/500000 - (73161*g*cos(th3))/500000 - (32169*g*sin(th3 + th4))/200000
    (1533389*g*cos(th3 + th4))/1000000 - (32169*g*sin(th3 + th4))/200000];

